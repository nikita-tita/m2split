(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{6655:function(e,t,r){Promise.resolve().then(r.bind(r,7760))},7760:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var s=r(7437),a=r(2265),n=r(6383),l=r(9178),i=r(4226),c=r(8068),d=r(9379),o=r(9205);let m=(0,o.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function u(e){let{isOpen:t,onClose:r,title:a,children:n}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:r}),(0,s.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:(0,s.jsxs)("div",{className:"bg-white px-6 pt-5 pb-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a}),(0,s.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:(0,s.jsx)(m,{className:"w-6 h-6"})})]}),n]})})]})}):null}var x=r(5930),h=r(9397),p=r(1671);let g=(0,o.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var f=r(2097),j=r(1384);function b(){let{contractors:e,addContractor:t,updateContractor:r}=(0,f.o)(),[o,m]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null),[v,N]=(0,a.useState)({name:"",inn:"",kpp:"",accountNumber:"",bik:"",bankName:"",address:"",taxRegime:"USN",role:"AGENT"}),k=e=>{y(e.id),N({name:e.name,inn:e.inn,kpp:e.kpp||"",accountNumber:e.accountNumber,bik:e.bik,bankName:e.bankName,address:e.address,taxRegime:e.taxRegime,role:e.role}),m(!0)},w=(e,t)=>{N({...v,[e]:t})};return(0,s.jsxs)(n.Layout,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Контрагенты и оферты"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Управление исполнителями и акцептом оферт"})]}),(0,s.jsxs)(i.z,{onClick:()=>{y(null),N({name:"",inn:"",kpp:"",accountNumber:"",bik:"",bankName:"",address:"",taxRegime:"USN",role:"AGENT"}),m(!0)},children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"Добавить контрагента"]})]}),(0,s.jsx)(l.Z,{padding:"none",children:(0,s.jsxs)(x.iA,{children:[(0,s.jsx)(x.xD,{children:(0,s.jsxs)(x.SC,{children:[(0,s.jsx)(x.pj,{header:!0,children:"Наименование"}),(0,s.jsx)(x.pj,{header:!0,children:"ИНН"}),(0,s.jsx)(x.pj,{header:!0,children:"Роль"}),(0,s.jsx)(x.pj,{header:!0,children:"Режим"}),(0,s.jsx)(x.pj,{header:!0,children:"Счёт"}),(0,s.jsx)(x.pj,{header:!0,children:"Банк"}),(0,s.jsx)(x.pj,{header:!0,children:"Оферта"}),(0,s.jsx)(x.pj,{header:!0,children:" "})]})}),(0,s.jsx)(x.RM,{children:e.map(e=>(0,s.jsxs)(x.SC,{children:[(0,s.jsx)(x.pj,{children:(0,s.jsx)("div",{className:"font-medium",children:e.name})}),(0,s.jsx)(x.pj,{children:(0,s.jsx)("span",{className:"font-mono text-sm",children:e.inn})}),(0,s.jsx)(x.pj,{children:(0,s.jsxs)(d.C,{size:"sm",variant:"info",children:["AGENCY"===e.role&&"АН","AGENT"===e.role&&"Агент","IP"===e.role&&"ИП","NPD"===e.role&&"НПД"]})}),(0,s.jsx)(x.pj,{children:(0,s.jsx)(d.C,{size:"sm",children:(0,j.gG)(e.taxRegime)})}),(0,s.jsx)(x.pj,{children:(0,s.jsx)("span",{className:"font-mono text-xs",children:e.accountNumber})}),(0,s.jsx)(x.pj,{children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("div",{children:e.bankName}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 font-mono",children:["БИК: ",e.bik]})]})}),(0,s.jsx)(x.pj,{children:e.offerAcceptedAt?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.Z,{className:"w-4 h-4 text-green-600"}),(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("div",{className:"text-green-600 font-medium",children:"Принято"}),(0,s.jsx)("div",{className:"text-gray-500",children:(0,j.o0)(e.offerAcceptedAt)})]})]}):(0,s.jsx)(d.C,{variant:"warning",children:"Не принято"})}),(0,s.jsx)(x.pj,{children:(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>k(e),children:(0,s.jsx)(g,{className:"w-4 h-4"})})})})]},e.id))})]})})]}),(0,s.jsx)(u,{isOpen:o,onClose:()=>m(!1),title:b?"Редактирование контрагента":"Добавление контрагента",children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b?r(b,{...v,kpp:v.kpp||void 0,updatedAt:new Date}):t({id:"c".concat(Date.now()),...v,kpp:v.kpp||void 0,createdAt:new Date,updatedAt:new Date}),m(!1)},className:"space-y-4",children:[(0,s.jsx)(c.I,{label:"Наименование",placeholder:"ООО Недвижимость Плюс",value:v.name,onChange:e=>w("name",e.target.value),required:!0}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(c.I,{label:"ИНН",placeholder:"7701234567",value:v.inn,onChange:e=>w("inn",e.target.value),required:!0}),(0,s.jsx)(c.I,{label:"КПП (опционально)",placeholder:"770101001",value:v.kpp,onChange:e=>w("kpp",e.target.value)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(c.P,{label:"Роль",value:v.role,onChange:e=>w("role",e.target.value),options:[{value:"AGENCY",label:"Агентство недвижимости"},{value:"AGENT",label:"Агент"},{value:"IP",label:"Индивидуальный предприниматель"},{value:"NPD",label:"Самозанятый (НПД)"}]}),(0,s.jsx)(c.P,{label:"Налоговый режим",value:v.taxRegime,onChange:e=>w("taxRegime",e.target.value),options:[{value:"VAT",label:"НДС"},{value:"USN",label:"УСН"},{value:"NPD",label:"НПД"}]})]}),(0,s.jsx)(c.I,{label:"Расчётный счёт",placeholder:"40702810100000001234",value:v.accountNumber,onChange:e=>w("accountNumber",e.target.value),required:!0}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(c.I,{label:"БИК банка",placeholder:"044525225",value:v.bik,onChange:e=>w("bik",e.target.value),required:!0}),(0,s.jsx)(c.I,{label:"Наименование банка",placeholder:"ПАО Сбербанк",value:v.bankName,onChange:e=>w("bankName",e.target.value),required:!0})]}),(0,s.jsx)(c.I,{label:"Адрес",placeholder:"г. Москва, ул. Примерная, д. 1",value:v.address,onChange:e=>w("address",e.target.value),required:!0}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)(i.z,{type:"button",variant:"secondary",onClick:()=>m(!1),children:"Отмена"}),(0,s.jsx)(i.z,{type:"submit",children:b?"Сохранить":"Добавить"})]})]})})]})}},6383:function(e,t,r){"use strict";r.d(t,{Layout:function(){return f}});var s=r(7437);r(2265);var a=r(7648),n=r(9376),l=r(1994),i=r(5466),c=r(8736),d=r(9277),o=r(8226),m=r(7117),u=r(5805),x=r(8728),h=r(7692),p=r(2097);let g=[{name:"Дашборд",href:"/dashboard",icon:i.Z},{name:"Сделки",href:"/deals",icon:c.Z},{name:"Реестры",href:"/registries",icon:d.Z},{name:"Выплаты",href:"/payments",icon:o.Z},{name:"Документы",href:"/documents",icon:m.Z},{name:"Контрагенты",href:"/contractors",icon:u.Z},{name:"Настройки",href:"/settings",icon:x.Z}],f=e=>{let{children:t}=e,r=(0,n.usePathname)(),{currentUser:i}=(0,p.o)();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"fixed inset-y-0 left-0 w-64 bg-white border-r border-gray-200",children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"flex items-center h-16 px-6 border-b border-gray-200",children:(0,s.jsx)("h1",{className:"text-xl font-bold text-primary-600",children:"M2 Split"})}),(0,s.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-1 overflow-y-auto",children:g.map(e=>{let t=e.icon,n=r===e.href;return(0,s.jsxs)(a.default,{href:e.href,className:(0,l.W)("flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors",n?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"),children:[(0,s.jsx)(t,{className:"w-5 h-5 mr-3"}),e.name]},e.name)})}),i&&(0,s.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:i.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["DEVELOPER_ADMIN"===i.role&&"Застройщик","M2_OPERATOR"===i.role&&"Оператор М2","CONTRACTOR"===i.role&&"Исполнитель","BANK_INTEGRATION"===i.role&&"Банк"]})]}),(0,s.jsx)("button",{className:"ml-3 p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",title:"Выйти",children:(0,s.jsx)(h.Z,{className:"w-5 h-5"})})]})})]})}),(0,s.jsx)("div",{className:"pl-64",children:(0,s.jsx)("main",{className:"p-8",children:t})})]})}},9379:function(e,t,r){"use strict";r.d(t,{C:function(){return n}});var s=r(7437);r(2265);var a=r(1994);let n=e=>{let{children:t,variant:r="default",size:n="md"}=e;return(0,s.jsx)("span",{className:(0,a.W)("inline-flex items-center rounded-full font-medium",{default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"}[r],{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm"}[n]),children:t})}},4226:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var s=r(7437);r(2265);var a=r(1994);let n=e=>{let{variant:t="primary",size:r="md",className:n,children:l,disabled:i,...c}=e;return(0,s.jsx)("button",{className:(0,a.W)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r],n),disabled:i,...c,children:l})}},9178:function(e,t,r){"use strict";r.d(t,{O:function(){return l},Z:function(){return n}});var s=r(7437);r(2265);var a=r(1994);let n=e=>{let{children:t,className:r,padding:n="md"}=e;return(0,s.jsx)("div",{className:(0,a.W)("bg-white rounded-lg shadow-sm border border-gray-200",{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[n],r),children:t})},l=e=>{let{title:t,subtitle:r,action:a}=e;return(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:t}),r&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:r})]}),a&&(0,s.jsx)("div",{children:a})]})}},8068:function(e,t,r){"use strict";r.d(t,{I:function(){return n},P:function(){return l}});var s=r(7437);r(2265);var a=r(1994);let n=e=>{let{label:t,error:r,helperText:n,className:l,...i}=e;return(0,s.jsxs)("div",{className:"w-full",children:[t&&(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,s.jsx)("input",{className:(0,a.W)("w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",r?"border-red-300":"border-gray-300",l),...i}),r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r}),n&&!r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n})]})},l=e=>{let{label:t,error:r,options:n,className:l,...i}=e;return(0,s.jsxs)("div",{className:"w-full",children:[t&&(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,s.jsx)("select",{className:(0,a.W)("w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",r?"border-red-300":"border-gray-300",l),...i,children:n.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r})]})}},5930:function(e,t,r){"use strict";r.d(t,{RM:function(){return i},SC:function(){return c},iA:function(){return n},pj:function(){return d},xD:function(){return l}});var s=r(7437);r(2265);var a=r(1994);let n=e=>{let{children:t,className:r}=e;return(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsx)("table",{className:(0,a.W)("min-w-full divide-y divide-gray-200",r),children:t})})},l=e=>{let{children:t}=e;return(0,s.jsx)("thead",{className:"bg-gray-50",children:t})},i=e=>{let{children:t}=e;return(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t})},c=e=>{let{children:t,onClick:r,className:n}=e;return(0,s.jsx)("tr",{className:(0,a.W)(r&&"cursor-pointer hover:bg-gray-50",n),onClick:r,children:t})},d=e=>{let{children:t,header:r,className:n}=e;return r?(0,s.jsx)("th",{className:(0,a.W)("px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",n),children:t}):(0,s.jsx)("td",{className:(0,a.W)("px-6 py-4 whitespace-nowrap text-sm text-gray-900",n),children:t})}},2097:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});let s=(0,r(3011).U)(e=>({currentUser:null,setCurrentUser:t=>e({currentUser:t}),deals:[],setDeals:t=>e({deals:t}),addDeal:t=>e(e=>({deals:[...e.deals,t]})),updateDeal:(t,r)=>e(e=>({deals:e.deals.map(e=>e.id===t?{...e,...r}:e)})),registries:[],setRegistries:t=>e({registries:t}),addRegistry:t=>e(e=>({registries:[...e.registries,t]})),updateRegistry:(t,r)=>e(e=>({registries:e.registries.map(e=>e.id===t?{...e,...r}:e)})),contractors:[],setContractors:t=>e({contractors:t}),addContractor:t=>e(e=>({contractors:[...e.contractors,t]})),updateContractor:(t,r)=>e(e=>({contractors:e.contractors.map(e=>e.id===t?{...e,...r}:e)})),payments:[],setPayments:t=>e({payments:t}),updatePayment:(t,r)=>e(e=>({payments:e.payments.map(e=>e.id===t?{...e,...r}:e)})),settings:{companyName:"ООО 'СтройДевелопмент'",inn:"7701234567",kpp:"770101001",address:"г. Москва, ул. Строителей, д. 1",currentAccount:"40702810100000001234",specialAccount:"40702810200000002345",bik:"044525225",bankName:"ПАО Сбербанк",apiKey:"sk_test_••••••••••••••••",webhookUrl:"",ipWhitelist:""},updateSettings:t=>e(e=>({settings:{...e.settings,...t}}))}))},1384:function(e,t,r){"use strict";r.d(t,{gG:function(){return l},o0:function(){return n},p6:function(){return a},xG:function(){return s}});let s=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),a=e=>{let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},n=e=>{let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},l=e=>({VAT:"НДС",USN:"УСН",NPD:"НПД"})[e]},1671:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[837,971,117,744],function(){return e(e.s=6655)}),_N_E=e.O()}]);