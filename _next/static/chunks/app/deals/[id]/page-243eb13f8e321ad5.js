(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{1666:function(e,s,t){Promise.resolve().then(t.bind(t,9147))},9147:function(e,s,t){"use strict";t.d(s,{default:function(){return g}});var a=t(7437),r=t(2265),c=t(824),d=t(9178),l=t(4226),n=t(9379),i=t(5930),x=t(1817),m=t(2660),h=t(5868),j=t(9277),o=t(8930),u=t(9397),N=t(1384),f=t(7887),p=t(7648);function g(e){let{id:s}=e,[t,g]=(0,r.useState)(null),[v,y]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{(async()=>{try{y(!0);let e=await f.P.getDeal(s);g(e)}catch(e){console.error("Failed to load deal:",e)}finally{y(!1)}})()},[s]),v)return(0,a.jsx)(c.A,{children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.Z,{className:"w-8 h-8 animate-spin mx-auto text-gray-400"}),(0,a.jsx)("p",{className:"text-gray-500 mt-4",children:"Загрузка сделки..."})]})});if(!t)return(0,a.jsx)(c.A,{children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Сделка не найдена"}),(0,a.jsx)(p.default,{href:"/deals",children:(0,a.jsx)(l.z,{className:"mt-4",children:"Вернуться к списку"})})]})});let b=t.shares.reduce((e,s)=>e+s.sharePercent,0);return(0,a.jsx)(c.A,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(p.default,{href:"/deals",children:(0,a.jsx)(l.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(m.Z,{className:"w-5 h-5"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t.objectName}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:t.objectAddress})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(l.z,{variant:"secondary",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"Редактировать"]}),(0,a.jsxs)(l.z,{children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 mr-2"}),"Сформировать реестр"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(d.Z,{className:"lg:col-span-2",children:[(0,a.jsx)(d.O,{title:"Информация о сделке"}),(0,a.jsxs)("dl",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"№ сделки"}),(0,a.jsx)("dd",{className:"mt-1 text-sm font-mono text-gray-900",children:t.dealNumber||t.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Лот"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:t.lotNumber||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Сумма КВН"}),(0,a.jsx)("dd",{className:"mt-1 text-sm font-semibold text-gray-900",children:(0,N.xG)(t.totalAmount)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Статус"}),(0,a.jsx)("dd",{className:"mt-1",children:(0,a.jsxs)(n.C,{variant:"IN_PROGRESS"===t.status?"info":"default",children:["DRAFT"===t.status&&"Черновик","IN_PROGRESS"===t.status&&"В работе","IN_REGISTRY"===t.status&&"В реестре","PAID"===t.status&&"Выплачено"]})})]}),t.contractNumber&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Договор №"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:t.contractNumber})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Дата договора"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:t.contractDate?(0,N.p6)(t.contractDate):"—"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Дата создания"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(0,N.p6)(t.createdAt)})]}),t.specialAccountReceiptDate&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Поступило на спецсчёт"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(0,N.p6)(t.specialAccountReceiptDate)})]})]})]}),(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(d.O,{title:"Валидация"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Сумма долей"}),(0,a.jsxs)(n.C,{variant:.01>Math.abs(b-100)?"success":"danger",children:[b.toFixed(2),"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Участников"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:t.shares.length})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Реквизиты"}),(0,a.jsx)(n.C,{variant:"success",children:"Заполнены"})]})]})]})]}),(0,a.jsxs)(d.Z,{padding:"none",children:[(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(d.O,{title:"Распределение долей"})}),(0,a.jsxs)(i.iA,{children:[(0,a.jsx)(i.xD,{children:(0,a.jsxs)(i.SC,{children:[(0,a.jsx)(i.pj,{header:!0,children:"Получатель"}),(0,a.jsx)(i.pj,{header:!0,children:"Роль"}),(0,a.jsx)(i.pj,{header:!0,children:"Доля %"}),(0,a.jsx)(i.pj,{header:!0,children:"Сумма"}),(0,a.jsx)(i.pj,{header:!0,children:"Режим"}),(0,a.jsx)(i.pj,{header:!0,children:"Ставка НДС"}),(0,a.jsx)(i.pj,{header:!0,children:"Договор"}),(0,a.jsx)(i.pj,{header:!0,children:" "})]})}),(0,a.jsx)(i.RM,{children:t.shares.map(e=>{var s,t;return(0,a.jsxs)(i.SC,{children:[(0,a.jsx)(i.pj,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:null===(s=e.contractor)||void 0===s?void 0:s.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["ИНН: ",null===(t=e.contractor)||void 0===t?void 0:t.inn]})]})}),(0,a.jsx)(i.pj,{children:(0,a.jsxs)(n.C,{size:"sm",variant:"info",children:["AGENCY"===e.role&&"АН","AGENT"===e.role&&"Агент","IP"===e.role&&"ИП","NPD"===e.role&&"НПД"]})}),(0,a.jsxs)(i.pj,{className:"font-medium",children:[e.sharePercent,"%"]}),(0,a.jsx)(i.pj,{className:"font-medium",children:(0,N.xG)(e.amount)}),(0,a.jsx)(i.pj,{children:(0,a.jsx)(n.C,{size:"sm",children:(0,N.gG)(e.taxRegime)})}),(0,a.jsx)(i.pj,{children:e.vatRate?"".concat(e.vatRate,"%"):"—"}),(0,a.jsx)(i.pj,{children:(0,a.jsxs)("div",{className:"text-xs",children:[e.contractNumber&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:e.contractNumber}),e.contractDate&&(0,a.jsx)("div",{className:"text-gray-500",children:(0,N.p6)(e.contractDate)})]}),!e.contractNumber&&"—"]})}),(0,a.jsx)(i.pj,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(h.Z,{className:"w-4 h-4"})}),(0,a.jsx)(l.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-red-600"})})]})})]},e.id)})})]}),(0,a.jsx)("div",{className:"p-4 bg-gray-50 border-t",children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Добавить получателя"]})})]})]})})}},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5868:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},8930:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[211,868,990,115,971,117,744],function(){return e(e.s=1666)}),_N_E=e.O()}]);