(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[657],{3422:function(e,t,a){Promise.resolve().then(a.bind(a,1368))},1368:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var r=a(7437),s=a(2265),o=a(824),l=a(9178),i=a(4226),n=a(8068),c=a(9379),d=a(5930),m=a(2660),u=a(3245),p=a(9397),h=a(8930),v=a(2097),j=a(3694),x=a(1384),f=a(9057),g=a(2141);let y=[{id:"prj-kvartal-domashniy",developerId:"dev-samolot",projectName:"ЖК \xabКвартал Домашний\xbb",region:"Москва",city:"Москва",address:"ул. Донецкая",isActive:!0,apartments:[{id:"apt-kvartal-1",projectId:"prj-kvartal-domashniy",lotNumber:"12-345",roomType:"STUDIO",area:28.5,floor:5,section:"А",price:85e5,status:"AVAILABLE",address:"ЖК \xabКвартал Домашний\xbb, ул. Донецкая, корпус А, кв. 12-345"},{id:"apt-kvartal-2",projectId:"prj-kvartal-domashniy",lotNumber:"14-267",roomType:"1_ROOM",area:42.3,floor:8,section:"Б",price:123e5,status:"AVAILABLE",address:"ЖК \xabКвартал Домашний\xbb, ул. Донецкая, корпус Б, кв. 14-267"},{id:"apt-kvartal-3",projectId:"prj-kvartal-domashniy",lotNumber:"15-189",roomType:"2_ROOM",area:65.7,floor:12,section:"А",price:189e5,status:"AVAILABLE",address:"ЖК \xabКвартал Домашний\xbb, ул. Донецкая, корпус А, кв. 15-189"},{id:"apt-kvartal-4",projectId:"prj-kvartal-domashniy",lotNumber:"16-034",roomType:"3_ROOM",area:89.2,floor:7,section:"Б",price:256e5,status:"AVAILABLE",address:"ЖК \xabКвартал Домашний\xbb, ул. Донецкая, корпус Б, кв. 16-034"}],createdAt:new Date,updatedAt:new Date},{id:"prj-soyuz",developerId:"dev-rodina",projectName:"ЖК \xabСОЮЗ\xbb",region:"Москва",city:"Москва",address:"ул. Сельскохозяйственная",isActive:!0,apartments:[{id:"apt-soyuz-1",projectId:"prj-soyuz",lotNumber:"03-112",roomType:"STUDIO",area:30.1,floor:3,section:"1",price:72e5,status:"AVAILABLE",address:"ЖК \xabСОЮЗ\xbb, ул. Сельскохозяйственная, корпус 1, кв. 03-112"},{id:"apt-soyuz-2",projectId:"prj-soyuz",lotNumber:"05-278",roomType:"1_ROOM",area:45.8,floor:9,section:"2",price:115e5,status:"AVAILABLE",address:"ЖК \xabСОЮЗ\xbb, ул. Сельскохозяйственная, корпус 2, кв. 05-278"},{id:"apt-soyuz-3",projectId:"prj-soyuz",lotNumber:"07-145",roomType:"2_ROOM",area:68.4,floor:15,section:"1",price:178e5,status:"AVAILABLE",address:"ЖК \xabСОЮЗ\xbb, ул. Сельскохозяйственная, корпус 1, кв. 07-145"},{id:"apt-soyuz-4",projectId:"prj-soyuz",lotNumber:"08-056",roomType:"3_ROOM",area:92.6,floor:11,section:"2",price:242e5,status:"AVAILABLE",address:"ЖК \xabСОЮЗ\xbb, ул. Сельскохозяйственная, корпус 2, кв. 08-056"},{id:"apt-soyuz-5",projectId:"prj-soyuz",lotNumber:"09-023",roomType:"4_ROOM",area:115.3,floor:18,section:"1",price:321e5,status:"AVAILABLE",address:"ЖК \xabСОЮЗ\xbb, ул. Сельскохозяйственная, корпус 1, кв. 09-023"}],createdAt:new Date,updatedAt:new Date}];class b{async getProjects(e){if(!(0,g.jv)())return console.warn("\uD83D\uDCE6 Using mock data (Supabase not configured)"),y;try{let t=g.OQ.from("projects").select("*").order("project_name",{ascending:!0});(null==e?void 0:e.developerId)&&(t=t.eq("developer_id",e.developerId)),(null==e?void 0:e.city)&&(t=t.eq("city",e.city)),(null==e?void 0:e.isActive)!==void 0&&(t=t.eq("is_active",e.isActive));let{data:a,error:r}=await t;if(r)throw r;return(a||[]).map(this.transformFromDB)}catch(e){throw console.error("Error fetching projects:",e),e}}async getProject(e){if(!(0,g.jv)())return y.find(t=>t.id===e)||null;try{let{data:t,error:a}=await g.OQ.from("projects").select("*").eq("id",e).single();if(a)throw a;if(!t)return null;return this.transformFromDB(t)}catch(e){return console.error("Error fetching project:",e),null}}transformFromDB(e){return{id:e.id,developerId:e.developer_id,projectName:e.project_name,region:e.region,city:e.city,address:e.address,description:e.description,isActive:e.is_active,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)}}}let N=new b,A=[{id:"tariff-1",tariffId:"TAR-SAMOLET-BASE",developerId:"dev-samolet",developerName:"Группа \xabСамолет\xbb",developerLegalEntity:"ООО \xabСамолет\xbb",projectId:"prj-kvartal-domashniy",projectName:"ЖК \xabКвартал Домашний\xbb",region:"Москва",city:"Москва",segment:"FLATS",objectCategory:"1_ROOM",paymentStage:"ADVANCE",commissionSchemeType:"PERCENT_OF_CONTRACT",commissionTotalPercent:2.7,promoFlag:"BASE",validFrom:new Date("2025-01-01"),validTo:new Date("2025-11-30"),isActive:!0,createdAt:new Date,updatedAt:new Date}];class I{async getTariffs(e){if(!(0,g.jv)())return console.log("Using mock tariffs"),A.filter(t=>(null==e||!e.developerId||t.developerId===e.developerId)&&(null==e||!e.projectId||t.projectId===e.projectId)&&(null==e||!e.segment||t.segment===e.segment)&&(null==e||!e.objectCategory||t.objectCategory===e.objectCategory)&&(null==e||!e.paymentStage||t.paymentStage===e.paymentStage)&&((null==e?void 0:e.isActive)===void 0||t.isActive===e.isActive));let t=g.OQ.from("tariffs").select("*").order("valid_from",{ascending:!1});(null==e?void 0:e.developerId)&&(t=t.eq("developer_id",e.developerId)),(null==e?void 0:e.projectId)&&(t=t.eq("project_id",e.projectId)),(null==e?void 0:e.segment)&&(t=t.eq("segment",e.segment)),(null==e?void 0:e.objectCategory)&&(t=t.eq("object_category",e.objectCategory)),(null==e?void 0:e.paymentStage)&&(t=t.eq("payment_stage",e.paymentStage)),(null==e?void 0:e.isActive)!==void 0&&(t=t.eq("is_active",e.isActive));let{data:a,error:r}=await t;if(r)throw console.error("Error fetching tariffs:",r),r;return this.mapToTariffs(a||[])}async getTariff(e){if(!(0,g.jv)())return A.find(t=>t.id===e)||null;let{data:t,error:a}=await g.OQ.from("tariffs").select("*").eq("id",e).single();return a?(console.error("Error fetching tariff:",a),null):t?this.mapToTariff(t):null}async findBestTariff(e){let t={projectId:e.projectId,isActive:!0};e.developerId&&(t.developerId=e.developerId),e.segment&&(t.segment=e.segment),e.objectCategory&&(t.objectCategory=e.objectCategory);let a=await this.getTariffs(t);return 0===a.length?null:a.sort((e,t)=>{let a=e.commissionTotalPercent||0;return(t.commissionTotalPercent||0)-a})[0]}calculateCommission(e,t){if("PERCENT_OF_CONTRACT"===t.commissionSchemeType){let a=e*(t.commissionTotalPercent||0)/100;return t.commissionMinAmount&&a<t.commissionMinAmount&&(a=t.commissionMinAmount),t.commissionMaxAmount&&a>t.commissionMaxAmount&&(a=t.commissionMaxAmount),a}return"FIXED_AMOUNT"===t.commissionSchemeType&&t.commissionFixedAmount||0}getTariffDisplayInfo(e){return"PERCENT_OF_CONTRACT"===e.commissionSchemeType?"".concat(e.commissionTotalPercent,"% (максимальный тариф)"):"FIXED_AMOUNT"===e.commissionSchemeType?"".concat(e.commissionFixedAmount," ₽ (фикс.)"):"Ступенчатая шкала"}mapToTariff(e){return{id:e.id,tariffId:e.tariff_id,developerId:e.developer_id,developerName:e.developer_name,developerLegalEntity:e.developer_legal_entity,projectId:e.project_id,projectName:e.project_name,region:e.region,city:e.city,segment:e.segment,objectCategory:e.object_category,paymentStage:e.payment_stage,commissionSchemeType:e.commission_scheme_type,commissionTotalPercent:e.commission_total_percent,commissionFixedAmount:e.commission_fixed_amount,commissionMinAmount:e.commission_min_amount,commissionMaxAmount:e.commission_max_amount,promoFlag:e.promo_flag,promoDescription:e.promo_description,validFrom:new Date(e.valid_from),validTo:e.valid_to?new Date(e.valid_to):void 0,isActive:e.is_active,comments:e.comments,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)}}mapToTariffs(e){return e.map(e=>this.mapToTariff(e))}}let T=new I;var _=a(8509),C=a(3702),O=a(8332),E=a(9280),w=a(7648),D=a(9376);function S(){let e=(0,D.useRouter)(),{addDeal:t,currentRole:a}=(0,v.o)(),g=["M2_OPERATOR","AGENCY_ADMIN","CONTRACTOR"].includes(a),y="M2_OPERATOR"===a,b="AGENCY_ADMIN"===a,A="CONTRACTOR"===a,[I,S]=(0,s.useState)([]),[R,M]=(0,s.useState)([]),[P,k]=(0,s.useState)(""),[L,z]=(0,s.useState)(""),[F,q]=(0,s.useState)([]),[B,V]=(0,s.useState)(""),[Z,U]=(0,s.useState)([]),[G,Q]=(0,s.useState)(""),[Y,H]=(0,s.useState)(""),[X,W]=(0,s.useState)(""),[J,K]=(0,s.useState)(""),[$,ee]=(0,s.useState)(""),[et,ea]=(0,s.useState)(""),[er,es]=(0,s.useState)(""),[eo,el]=(0,s.useState)(""),[ei,en]=(0,s.useState)(""),[ec,ed]=(0,s.useState)(null),[em,eu]=(0,s.useState)(0),[ep,eh]=(0,s.useState)([]);(0,s.useEffect)(()=>{g||e.push("/deals")},[g,e]),(0,s.useEffect)(()=>{g&&ev()},[g]),(0,s.useEffect)(()=>{P?q(R.filter(e=>e.developerId===P)):q([]),z(""),V(""),U([]),Q(""),H(""),W("")},[P,R]),(0,s.useEffect)(()=>{if(L){let e=R.find(e=>e.id===L);e&&e.apartments?U(e.apartments.filter(e=>"AVAILABLE"===e.status)):U([])}else U([]);V("")},[L,R]),(0,s.useEffect)(()=>{if(B&&Z.length>0){let e=Z.find(e=>e.id===B);e&&(W(e.lotNumber),Q("".concat("STUDIO"===e.roomType?"Студия":"1_ROOM"===e.roomType?"1-комнатная":"2_ROOM"===e.roomType?"2-комнатная":"3_ROOM"===e.roomType?"3-комнатная":"4-комнатная"," ").concat(e.area," м\xb2")),H(e.address),K(e.price.toString()))}},[B,Z]),(0,s.useEffect)(()=>{(async()=>{if(L&&P)try{let e=await T.findBestTariff({developerId:P,projectId:L});if(ed(e),e&&J){let t=T.calculateCommission(parseFloat(J),e);eu(t)}else eu(0)}catch(e){console.error("Failed to find tariff:",e),ed(null),eu(0)}else ed(null),eu(0)})()},[L,P,J]),(0,s.useEffect)(()=>{em>0&&ep.length>0&&eh(e=>e.map(e=>({...e,amount:em*e.sharePercent/100})))},[em]);let ev=async()=>{try{let e=await f.f.getCounterparties({type:"DEVELOPER",offerAccepted:!0});S(e);let t=await N.getProjects({city:"Москва",isActive:!0});M(t)}catch(e){console.error("Failed to load developers/projects:",e)}},ej=e=>{eh(ep.filter((t,a)=>a!==e))},ex=(e,t,a)=>{let r=[...ep];r[e]={...r[e],[t]:a},"taxRegime"===t&&"OSN"===a?r[e].vatRate=20:"taxRegime"===t&&"OSN"!==a&&(r[e].vatRate=void 0),"sharePercent"===t&&em>0&&(r[e].amount=em*a/100),eh(r)},ef=ep.reduce((e,t)=>e+t.sharePercent,0),eg=.01>Math.abs(ef-100),ey=G&&Y&&J&&ep.length>0&&eg&&(b||y&&P&&L);return(0,r.jsx)(o.A,{children:(0,r.jsxs)("form",{onSubmit:r=>{if(r.preventDefault(),!ey)return;let s="d".concat(Date.now()),o=parseFloat(J),l=ep.map((e,t)=>{let a=j.dp.find(t=>t.id===e.contractorId);return{id:"s".concat(s,"_").concat(t),contractorId:e.contractorId,contractor:a,role:e.role,sharePercent:e.sharePercent,amount:e.amount,taxRegime:e.taxRegime,vatRate:e.vatRate,contractNumber:e.contractNumber||void 0,contractDate:e.contractDate?new Date(e.contractDate):void 0}});t({id:s,objectName:G,objectAddress:Y,lotNumber:X||void 0,developerId:P||void 0,projectId:L||void 0,totalAmount:o,status:"DRAFT",shares:l,contractNumber:$||void 0,contractDate:et?new Date(et):void 0,clientName:er||void 0,clientPhone:eo||void 0,clientEmail:ei||void 0,tariffId:null==ec?void 0:ec.id,commissionCalculatedAmount:em||void 0,commissionActualAmount:em||void 0,responsibleUserId:"2",initiator:{role:"M2_OPERATOR",partyId:"1",userId:"2",timestamp:new Date},createdAt:new Date,updatedAt:new Date}),_.W.logEvent({type:"DEAL_CREATED",entityType:"DEAL",entityId:s,userId:"2",userName:"Current User",userRole:a,description:"Сделка создана: ".concat(G),metadata:{objectName:G,objectAddress:Y,totalAmount:o,commissionAmount:em,participantsCount:ep.length,developerId:P,projectId:L}}),e.push("/deals/".concat(s))},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(w.default,{href:"/deals",children:(0,r.jsx)(i.z,{type:"button",variant:"ghost",size:"sm",children:(0,r.jsx)(m.Z,{className:"w-5 h-5"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Создание сделки"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Укажите объект и распределите доли между участниками"}),y&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-blue-600",children:[(0,r.jsx)(u.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Система работает только для объектов в Москве"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(w.default,{href:"/deals",children:(0,r.jsx)(i.z,{type:"button",variant:"secondary",children:"Отмена"})}),(0,r.jsx)(i.z,{type:"submit",disabled:!ey,children:"Создать сделку"})]})]}),A&&(0,r.jsx)(E.N,{id:"contractor-deal-form",title:"\uD83C\uDFE0 Выберите застройщика, ЖК и квартиру",description:"Сначала выберите застройщика, затем ЖК (проект), затем квартиру из списка доступных. Все данные (название, адрес, лот, цена) заполнятся автоматически! Система рассчитает комиссию КВН по тарифу М2 с застройщиком, и вы сможете распределить доли между участниками."}),(0,r.jsx)(C.E,{...O.p.dealCreation}),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(l.O,{title:"Основная информация"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(n.P,{label:"Застройщик",value:P,onChange:e=>k(e.target.value),options:[{value:"",label:"Выберите застройщика"},...I.map(e=>({value:e.id,label:e.name}))],required:!0}),(0,r.jsx)(n.P,{label:"Проект / ЖК",value:L,onChange:e=>z(e.target.value),options:[{value:"",label:P?"Выберите проект":"Сначала выберите застройщика"},...F.map(e=>({value:e.id,label:e.projectName}))],required:!0,disabled:!P})]}),L&&Z.length>0&&(0,r.jsx)(n.P,{label:"Квартира",value:B,onChange:e=>V(e.target.value),options:[{value:"",label:"Выберите квартиру"},...Z.map(e=>({value:e.id,label:"".concat(e.lotNumber," — ").concat("STUDIO"===e.roomType?"Студия":"1_ROOM"===e.roomType?"1к":"2_ROOM"===e.roomType?"2к":"3_ROOM"===e.roomType?"3к":"4к",", ").concat(e.area," м\xb2, ").concat(e.floor," этаж — ").concat((e.price/1e6).toFixed(1)," млн ₽")}))],required:!0}),(0,r.jsx)(n.I,{label:"Название объекта",placeholder:"ЖК Солнечный",value:G,onChange:e=>Q(e.target.value),required:!0,disabled:!L,helperText:B?"Заполнено автоматически на основе выбранной квартиры":""}),(0,r.jsx)(n.I,{label:"Адрес объекта",placeholder:"г. Москва, ул. Солнечная, д. 10",value:Y,onChange:e=>H(e.target.value),required:!0,disabled:!L,helperText:B?"Заполнено автоматически":""}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(n.I,{label:"Лот (квартира, офис)",placeholder:"Кв. 45",value:X,onChange:e=>W(e.target.value),disabled:!!B,helperText:B?"Заполнено автоматически":""}),(0,r.jsx)(n.I,{label:"Сумма договора с застройщиком (₽)",type:"number",placeholder:"15000000",value:J,onChange:e=>K(e.target.value),required:!0,disabled:!!B,helperText:B?"Заполнено автоматически (цена квартиры)":""})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(n.I,{label:"Номер договора",placeholder:"ДК-2024-001",value:$,onChange:e=>ee(e.target.value)}),(0,r.jsx)(n.I,{label:"Дата договора",type:"date",value:et,onChange:e=>ea(e.target.value)})]}),ec&&J&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Расчет комиссии КВН"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Тариф:"}),(0,r.jsx)("span",{className:"font-medium text-gray-900",children:T.getTariffDisplayInfo(ec)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Сумма договора:"}),(0,r.jsx)("span",{className:"font-medium text-gray-900",children:(0,x.xG)(parseFloat(J))})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-2 border-t border-blue-200",children:[(0,r.jsx)("span",{className:"font-semibold text-blue-900",children:"Комиссия КВН:"}),(0,r.jsx)("span",{className:"font-bold text-blue-900",children:(0,x.xG)(em)})]}),(0,r.jsx)("p",{className:"text-xs text-blue-700 mt-2",children:"* Расчет на основе уникального клиента (максимальный тариф)"})]})]})]})]}),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(l.O,{title:"Информация о клиенте"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"На кого бронируем объект"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(n.I,{label:"ФИО клиента",placeholder:"Иванов Иван Иванович",value:er,onChange:e=>es(e.target.value)}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(n.I,{label:"Телефон",type:"tel",placeholder:"+7 (999) 123-45-67",value:eo,onChange:e=>el(e.target.value)}),(0,r.jsx)(n.I,{label:"Email",type:"email",placeholder:"client@example.com",value:ei,onChange:e=>en(e.target.value)})]})]})]}),(0,r.jsxs)(l.Z,{padding:"none",children:[(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(l.O,{title:"Распределение долей"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Сумма долей: ",ef.toFixed(2),"%"," ",eg?(0,r.jsx)(c.C,{variant:"success",size:"sm",children:"✓ Корректно"}):(0,r.jsx)(c.C,{variant:"danger",size:"sm",children:"Должно быть 100%"})]})]}),(0,r.jsxs)(i.z,{type:"button",variant:"secondary",size:"sm",onClick:()=>{eh([...ep,{contractorId:"",role:"AGENT",sharePercent:0,amount:0,taxRegime:"USN",contractNumber:"",contractDate:""}])},children:[(0,r.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Добавить получателя"]})]})}),ep.length>0&&(0,r.jsxs)(d.iA,{children:[(0,r.jsx)(d.xD,{children:(0,r.jsxs)(d.SC,{children:[(0,r.jsx)(d.pj,{header:!0,children:"Контрагент"}),(0,r.jsx)(d.pj,{header:!0,children:"Роль"}),(0,r.jsx)(d.pj,{header:!0,children:"Доля %"}),(0,r.jsx)(d.pj,{header:!0,children:"Сумма"}),(0,r.jsx)(d.pj,{header:!0,children:"Режим"}),(0,r.jsx)(d.pj,{header:!0,children:"НДС %"}),(0,r.jsx)(d.pj,{header:!0,children:"Договор"}),(0,r.jsx)(d.pj,{header:!0,children:" "})]})}),(0,r.jsx)(d.RM,{children:ep.map((e,t)=>{var a;return(0,r.jsxs)(d.SC,{children:[(0,r.jsx)(d.pj,{children:(0,r.jsx)(n.P,{value:e.contractorId,onChange:e=>ex(t,"contractorId",e.target.value),options:[{value:"",label:"Выберите контрагента"},...j.dp.map(e=>({value:e.id,label:"".concat(e.name," (").concat(e.inn,")")}))]})}),(0,r.jsx)(d.pj,{children:(0,r.jsx)(n.P,{value:e.role,onChange:e=>ex(t,"role",e.target.value),options:[{value:"AGENCY",label:"АН"},{value:"AGENT",label:"Агент"},{value:"IP",label:"ИП"},{value:"NPD",label:"НПД"}]})}),(0,r.jsx)(d.pj,{children:(0,r.jsx)(n.I,{type:"number",step:"0.01",min:"0",max:"100",value:e.sharePercent||"",onChange:e=>ex(t,"sharePercent",parseFloat(e.target.value)||0)})}),(0,r.jsx)(d.pj,{className:"font-medium",children:em>0&&e.amount>0?(0,x.xG)(e.amount):"—"}),(0,r.jsx)(d.pj,{children:(0,r.jsx)(n.P,{value:e.taxRegime,onChange:e=>ex(t,"taxRegime",e.target.value),options:[{value:"OSN",label:"НДС"},{value:"USN",label:"УСН"},{value:"NPD",label:"НПД"}]})}),(0,r.jsx)(d.pj,{children:"OSN"===e.taxRegime?(0,r.jsx)(n.P,{value:(null===(a=e.vatRate)||void 0===a?void 0:a.toString())||"20",onChange:e=>ex(t,"vatRate",parseInt(e.target.value)),options:[{value:"0",label:"0%"},{value:"10",label:"10%"},{value:"20",label:"20%"}]}):"—"}),(0,r.jsx)(d.pj,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(n.I,{placeholder:"№ договора",value:e.contractNumber,onChange:e=>ex(t,"contractNumber",e.target.value)}),(0,r.jsx)(n.I,{type:"date",value:e.contractDate,onChange:e=>ex(t,"contractDate",e.target.value)})]})}),(0,r.jsx)(d.pj,{children:(0,r.jsx)(i.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>ej(t),children:(0,r.jsx)(h.Z,{className:"w-4 h-4 text-red-600"})})})]},t)})})]}),0===ep.length&&(0,r.jsx)("div",{className:"text-center py-12 border-t",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Нажмите “Добавить получателя” для распределения долей"})})]})]})})}},9280:function(e,t,a){"use strict";a.d(t,{N:function(){return m}});var r=a(7437),s=a(2265),o=a(2489),l=a(9205);let i=(0,l.Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),n=(0,l.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var c=a(4226),d=a(7648);function m(e){let{id:t,title:a,description:l,actionText:m,actionHref:u,onDismiss:p}=e,[h,v]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{localStorage.getItem("onboarding-tip-".concat(t))||v(!0)},[t]),h)?(0,r.jsxs)("div",{className:"bg-gradient-to-r from-primary-50 to-primary-100 border-2 border-primary-300 rounded-lg p-6 shadow-lg relative",children:[(0,r.jsx)("button",{onClick:()=>{localStorage.setItem("onboarding-tip-".concat(t),"true"),v(!1),null==p||p()},className:"absolute top-4 right-4 text-primary-500 hover:text-primary-700 transition-colors","aria-label":"Закрыть подсказку",children:(0,r.jsx)(o.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-12 h-12 bg-primary-500 rounded-full flex items-center justify-center",children:(0,r.jsx)(i,{className:"w-6 h-6 text-white"})})}),(0,r.jsxs)("div",{className:"flex-1 pr-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-primary-900 mb-2",children:a}),(0,r.jsx)("p",{className:"text-primary-800 leading-relaxed mb-4",children:l}),m&&u&&(0,r.jsx)(d.default,{href:u,children:(0,r.jsxs)(c.z,{size:"sm",className:"inline-flex items-center gap-2",children:[m,(0,r.jsx)(n,{className:"w-4 h-4"})]})})]})]})]}):null}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[211,545,990,514,790,971,117,744],function(){return e(e.s=3422)}),_N_E=e.O()}]);